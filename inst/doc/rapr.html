<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Jeffrey O. Hanson" />

<meta name="date" content="2015-11-04" />

<title>rapr: Identify Representative and Adequate Prioritisations in R</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">rapr: Identify Representative and Adequate Prioritisations in R</h1>
<h4 class="author"><em>Jeffrey O. Hanson</em></h4>
<h4 class="date"><em>2015-11-04</em></h4>
</div>


<div id="overview" class="section level2">
<h2>Overview</h2>
<p>A central aim in conservation is to maximise the long-term persistence of biodiversity. To achieve this, reserve networks must be sited in places that safeguard biodiversity patterns and processes. Here, we present a novel formulation of the reserve-selection problem to identify prioritisations that fulfill this objective. The representative and adequate sample problem (RASP) is a general multi-objective optimisation problem that can identify prioritisations that are adequate–in terms of how much of the feature is secured–and also representative–in terms of the spatial variation at locations where the feature is protected. Here, we present an R package to develop prioritisations using this formulation of the reserve-selection problem. We examine the behaviour of this formulation using several simulated species and a case-study species.</p>
</div>
<div id="problem-formulation" class="section level2">
<h2>Problem formulation</h2>
</div>
<div id="classes" class="section level2">
<h2>Classes</h2>
</div>
<div id="simulated-examples" class="section level2">
<h2>Simulated examples</h2>
<div id="data" class="section level3">
<h3>Data</h3>
<p>To investigate the behaviour of the problem, we will generate prioritisations for three simulated species. To reduce computational effort, we will use the unreliable formulation of the problem. The first species (termed ‘uniform’) will represent a hyper-generalist. This species will inhabit all areas with equal probability. The second species (termed ‘normal’) will represent a species with a single range core. The third species (termed ‘bimodal’) will represent a species with two distinct ecotypes, each with their own range core. To reduce computational time for this example, we will use a <span class="math">\(15 \times 15\)</span> grid of square planning units.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make planning units</span>
sim_pus &lt;-<span class="st"> </span><span class="kw">sim.pus</span>(100L)

<span class="co"># simulate species distributions</span>
sim_spp &lt;-<span class="st"> </span><span class="kw">lapply</span>(
    <span class="kw">c</span>(<span class="st">'uniform'</span>, <span class="st">'normal'</span>, <span class="st">'bimodal'</span>),
    sim.species,
  <span class="dt">n=</span><span class="dv">1</span>,
  <span class="dt">x=</span>sim_pus,
  <span class="dt">res=</span><span class="dv">1</span>
)</code></pre>
<p>Let’s see what these species’ distributions look like. Each square represents a planning unit, and the color of each denotes square denotes the probability of the species in the planning unit.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># change the plot parameters, so we can plot the distributions side by side</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))

<span class="co"># uniform species</span>
<span class="kw">plot</span>(sim_spp[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">'uniform species'</span>)
<span class="kw">lines</span>(sim_pus)

<span class="co"># normal species</span>
<span class="kw">plot</span>(sim_spp[[<span class="dv">2</span>]], <span class="dt">main=</span><span class="st">'normal species'</span>)
<span class="kw">lines</span>(sim_pus)

<span class="co"># bimodal species</span>
<span class="kw">plot</span>(sim_spp[[<span class="dv">3</span>]], <span class="dt">main=</span><span class="st">'bimodal species'</span>)
<span class="kw">lines</span>(sim_pus)

<span class="co"># reset plot parameters</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre>
<p>Next, we will generate a set of demand points. To understand the effects of probabilities and weights on the demand points, we will generate the demand points in geographic space. These demand points will be the centroids of the planning units. Additionally, we will use the same set of demand points for each species and only vary the weights of the demand points between species.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generate coordinates for pus/demand points</span>
pu_coords &lt;-<span class="st"> </span>rgeos::<span class="kw">gCentroid</span>(sim_pus, <span class="dt">byid=</span><span class="ot">TRUE</span>)

<span class="co"># calculate weights</span>
sim_dps &lt;-<span class="st"> </span><span class="kw">lapply</span>(
    sim_spp,
    function(x) {
        <span class="kw">return</span>(<span class="kw">extract</span>(x, pu_coords))
    }
)

<span class="co"># create demand point objects</span>
sim_dps &lt;-<span class="st"> </span><span class="kw">lapply</span>(
    sim_dps,
    function(x) {
        <span class="kw">return</span>(
            <span class="kw">DemandPoints</span>(
                <span class="kw">SimplePoints</span>(pu_coords@coords),
                <span class="kw">c</span>(x)
            )
        )
    }
)</code></pre>
<p>Now, we will construct a <code>RapUnsolved</code> object to store our input data and parameters. This contains all the information to generate prioritisations.</p>
<pre class="sourceCode r"><code class="sourceCode r">## create RapUnreliableOpts object
<span class="co"># this stores parameters for the problem (eg. BLM)</span>
sim_ro &lt;-<span class="st"> </span><span class="kw">RapUnreliableOpts</span>()

## create RapData object
<span class="co"># create data.frame with species info</span>
species &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">name=</span><span class="kw">c</span>(<span class="st">'uniform'</span>, <span class="st">'normal'</span>, <span class="st">'bimodal'</span>)
)

## create data.frame with species and space targets
<span class="co"># amount targets at 20% (denoted with target=0)</span>
<span class="co"># space targets at 20% (denoted with target=1)</span>
targets &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(
  <span class="dt">species=</span><span class="dv">1</span>:<span class="dv">3</span>,
  <span class="dt">target=</span><span class="dv">0</span>:<span class="dv">1</span>,
  <span class="dt">proportion=</span><span class="fl">0.2</span>
)

<span class="co"># calculate probability of each species in each pu</span>
pu_probabilities &lt;-<span class="st"> </span><span class="kw">calcSpeciesAverageInPus</span>(sim_pus, <span class="kw">stack</span>(sim_spp))

## create AttributeSpace object
<span class="co"># this stores the coordinates of the planning units in an attribute space</span>
<span class="co"># and the coordinates and weights of demand points in the space</span>
attr_space &lt;-<span class="st"> </span><span class="kw">AttributeSpace</span>(
  <span class="kw">SimplePoints</span>(pu_coords@coords),
  sim_dps
)

<span class="co"># generate boundary data information</span>
boundary &lt;-<span class="st"> </span><span class="kw">calcBoundaryData</span>(sim_pus)

## create RapData object
<span class="co"># this store all the input data for the prioritisation</span>
sim_rd &lt;-<span class="st"> </span><span class="kw">RapData</span>(
  sim_pus@data,
  species,
  targets,
  pu_probabilities,
  <span class="kw">list</span>(attr_space),
  boundary,
  <span class="kw">SpatialPolygons2PolySet</span>(sim_pus)
)

## create RapUnsolved object
<span class="co"># this store all the input data and parameters needed to generate prioritisations</span>
sim_ru &lt;-<span class="st"> </span><span class="kw">RapUnsolved</span>(sim_ro, sim_rd)</code></pre>
</div>
<div id="single-species-prioritisations" class="section level3">
<h3>Single-species prioritisations</h3>
<p>Let’s keep things simple to start off with. First we will generate a prioritisation for each species using only amount-based targets. Then, we will generate prioritisations for each species using a combination of amount-based and space-based targets. We will then compare the prioritisations to see how they differ to see how including space-based targets can change prioritisaitons under the simplest of circumstances.</p>
<p>Let’s generate a prioritisation for the uniform species using amount-based targets. To do this we will subset out the data relating to the uniform species and the planning units from the <code>sim_ru</code> object. Then, we will <code>update</code> the targets in the new object. Finally we will need to <code>solve</code> the object to generate a prioritisation that fulfills the targets for minimal cost.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create new object with just the uniform species</span>
sim_ru_s1 &lt;-<span class="st"> </span><span class="kw">spp.subset</span>(sim_ru, <span class="st">'uniform'</span>)

<span class="co"># update amount targets to 20% and space targets to 0%</span>
sim_ru_s1 &lt;-<span class="st"> </span><span class="kw">update</span>(sim_ru_s1, <span class="dt">amount.target=</span><span class="fl">0.2</span>, <span class="dt">space.target=</span><span class="dv">0</span>, <span class="dt">solve=</span><span class="ot">FALSE</span>)

<span class="co"># solve problem to identify prioritisation</span>
sim_rs_s1_amount &lt;-<span class="st"> </span><span class="kw">solve</span>(sim_ru_s1)</code></pre>
<p>Now that we have generated a prioritisation, we will see what it looks like. We can use the <code>plot</code> method to plot the spatial distribution of the planning units. Planning units with a dark green fill are selected for prioritsation, and those with a pale green color have not. Additionally, we can use the <code>spp.plot</code> method to see how the prioritisation overlaps with the species’ distribution. The fill of the planning units indicates the probability that they are occupied by the species. Since all planning units have equal probabilities for this species, all planning units have the same color. Planning units with a green border are included for prioritisation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the prioritisation</span>
<span class="kw">plot</span>(sim_rs_s1_amount)

<span class="co"># plot the prioritisation and the uniform species' distribution</span>
<span class="kw">spp.plot</span>(sim_rs_s1_amount)</code></pre>
<p>The prioritisation for the uniform species appears to be just a random selection of planning units. This behavior is due to the fact that any prioritisation with <code>sum(selections(sim_ru_s1))</code> planning units is optimal. By relying on just amount targets, this solution may preserve a section of the species’ range core, or just focus on the range margin, or some random part of its range–no emphasis is directed towards preserving different parts of the species’ range. This behavior highlights a fundamental limitation of just using amount-based targets. In the absence of additional criteria, reserve selection problems do not contain any additional information to identify the most effective prioritisation.</p>
<p>Now, we will generate a prioritisation for the normally distributed species using amount-targets. We will use a similar process to what we used for the uniformly distributed species, but for brevity, we will generate solutions immediately after updating the object.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create new object with just the normal species</span>
sim_ru_s2 &lt;-<span class="st"> </span><span class="kw">spp.subset</span>(sim_ru, <span class="st">'normal'</span>)

<span class="co"># update amount targets to 20% and space targets to 0% and solve it</span>
sim_rs_s2_amount &lt;-<span class="st"> </span><span class="kw">update</span>(sim_ru_s2, <span class="dt">amount.target=</span><span class="fl">0.2</span>, <span class="dt">space.target=</span><span class="dv">0</span>, <span class="dt">solve=</span><span class="ot">TRUE</span>)</code></pre>
<p>Now let’s visualise the prioritisation we made for the normal species.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the prioritisation</span>
<span class="kw">plot</span>(sim_rs_s2_amount)

<span class="co"># plot the prioritisation and the normal species' distribution</span>
<span class="kw">spp.plot</span>(sim_rs_s2_amount)</code></pre>
<p>The amount-based prioritisation for the normal species focuses only on the species’ range core. This prioritisation fails to secure any peripheral parts of the species’ distribution. As a consequence, it may miss out on populations with novel adaptations to environmental conditions along the species’ range margin.</p>
<p>Now, let’s generate an amount-based target for the bimodally distributed species, and visualise it.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create new object with just the bimodal species</span>
sim_ru_s3 &lt;-<span class="st"> </span><span class="kw">spp.subset</span>(sim_ru, <span class="st">'bimodal'</span>)

<span class="co"># update amount targets to 20% and space targets to 0% and solve it</span>
sim_rs_s3_amount &lt;-<span class="st"> </span><span class="kw">update</span>(sim_ru_s3, <span class="dt">amount.target=</span><span class="fl">0.2</span>, <span class="dt">space.target=</span><span class="dv">0</span>)

<span class="co"># plot the prioritisation</span>
<span class="kw">plot</span>(sim_rs_s3_amount)

<span class="co"># plot the prioritisation and the bimodal species' distribution</span>
<span class="kw">spp.plot</span>(sim_rs_s3_amount)</code></pre>
<p>The amount-based prioritisation for the bimodally distributed species only selects plannig units in the bottom left corner of the study area. This prioritisation only preserves individuals belonging to one of the two ecotypes. As a consequence, this prioritisaiton fails to preserve a representative sample of the genetic variation found inside this species.</p>
<p>Now that we have generated a prioritisation for each species that only considers amount-targets, we will generate a prioritisation for each species that considers both amount-based and space-targets. To do this we will update the space targets in our amount-based prioritisations, and store the prioritisations in new objects.</p>
<p>First, let’s do this for the uniform species.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make new prioritisation</span>
sim_rs_s1_space &lt;-<span class="st"> </span><span class="kw">update</span>(sim_rs_s1_amount, <span class="dt">space.target=</span><span class="fl">0.2</span>)</code></pre>
<p>Let’s take a look at the prioritisation for the uniform species with amount-based and space-based targets. Then, let’s compare the solutions for the amount-based prioritisation with the new prioritisation using both amount and space targets.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the prioritisation</span>
<span class="kw">plot</span>(sim_rs_s1_space)

<span class="co"># plot the prioritisation and the uniform species' distribution</span>
<span class="kw">spp.plot</span>(sim_rs_s1_space)

<span class="co"># plot the difference between old and new prioritisations</span>
<span class="kw">plot</span>(sim_rs_s1_amount, sim_rs_s1_space, <span class="dv">1</span>, <span class="dv">1</span>)</code></pre>
<p>Here we can see that by including a space-target the prioritisation is spread out evenly across the species’ distribution. Unlike the amount-based prioritisation, this prioritisation samples all the different parts of the species’ distribution.</p>
<p>Now, let’s generate a prioritisation for the normally distributed species that considers amount-based and space-based targets. Then, let’s visualise the new prioritisation and compare it to the old amount-based prioritisation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make new prioritisation</span>
sim_rs_s2_space &lt;-<span class="st"> </span><span class="kw">update</span>(sim_rs_s2_amount, <span class="dt">space.target=</span><span class="fl">0.2</span>)

<span class="co"># plot the prioritisation</span>
<span class="kw">plot</span>(sim_rs_s2_space)

<span class="co"># plot the prioritisation and the normal species' distribution</span>
<span class="kw">spp.plot</span>(sim_rs_s2_space)

<span class="co"># plot the difference between old and new prioritisations</span>
<span class="kw">plot</span>(sim_rs_s2_amount, sim_rs_s2_space, <span class="dv">1</span>, <span class="dv">1</span>)</code></pre>
<p>These plots show that the prioritisation which was generated using amount-based and space-based targets captures both the species’ range core and its range margin. As a consequence, it may capture any novel adaptations found along the species’ range margin–unlike the amount-based prioritisation.</p>
<p>Finally, let’s generate a prioritisation for the bimodal species using amount-based and space-based targets.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make new prioritisation</span>
sim_rs_s3_space &lt;-<span class="st"> </span><span class="kw">update</span>(sim_rs_s3_amount, <span class="dt">space.target=</span><span class="fl">0.2</span>)

<span class="co"># plot the prioritisation</span>
<span class="kw">plot</span>(sim_rs_s3_space)

<span class="co"># plot the prioritisation and the bimodal species' distribution</span>
<span class="kw">spp.plot</span>(sim_rs_s3_space)

<span class="co"># plot the difference between old and new prioritisations</span>
<span class="kw">plot</span>(sim_rs_s3_amount, sim_rs_s3_space, <span class="dv">1</span>, <span class="dv">1</span>)</code></pre>
<p>Earlier we found that the amount-based prioritisation only preserved individuals from a single ecotype, and would have failed to adequately preserve the intra-specific variation for this species. However, here we can see that by including space-based targets, we can develop prioritisations that the secure individuals belonging to both ecotypes. This new prioritisation is much more effective at sampling the intra-specific variation for this species.</p>
<p>Overall, these results demonstrate that under the simplest of conditions that the use of space-based targets can improve prioritisations. However, all these prioritisations were generated for a single species at a time. It is possible that by prioritisations generated using multiple species may do a better job at preserving the intra-specific variation for individuals species. We will investigate this in the next section.</p>
</div>
<div id="multi-species-prioritisations" class="section level3">
<h3>Multi-species prioritisations</h3>
<p>Previously, we have generated prioritisations for only one species at a time. However, real-world prioritisations are often generated for multiple-species. Here, we will generate prioritisations for all three of the simulated species. First, we will generate a prioritisation that only aims to preserve 20% of the area they occupy. Then, we will generate a prioritisation that also aims to preserve a representative portion of their geographic distribution. After doing this we will compare the two prioritisations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make prioritisations</span>
sim_mrs_area &lt;-<span class="st"> </span><span class="kw">solve</span>(sim_ru_area)
sim_mrs_space &lt;-<span class="st"> </span><span class="kw">solve</span>(sim_ru_space)

<span class="co"># plot prioritisations</span>
<span class="kw">plot</span>(sim_mrs_area)
<span class="kw">plot</span>(sim_mrs_space)</code></pre>
<p>Here we can see that the inclusion of space-based targets to ensure that prioritisations secure a representative portion of the species’ range changes the both the selection of planning units and also the number of planning units that are selected. The area-based prioritistion is comprised of <code>sum(sim_mrs_area@results@selections[1,])</code> units, and the space-based prioritisation is comprised of <code>sum(sim_mrs_space@results@selections[1,])</code> units. These simulated species demonstrate that under the simplest of distributions the inclusion of space-based targets can result in different prioritisations. However, real world planning exercises may use attribute spaces that have a complex relationship with geographic space, and this will affect the difference of including space-based targets.</p>
</div>
</div>
<div id="case-study-examples" class="section level2">
<h2>Case-study examples</h2>
<div id="overview-1" class="section level3">
<h3>Overview</h3>
<p>Here we will investigate how including space-based targets can affect prioritisations using a real-world dataset. We will generate prioritisations for the pale-headed rosella (<em>Platycercus adscitus</em>). This Australian bird species persists across broad environmental gradients across north-eastern Australia. Firstly, we will generate a typical area-based prioritisation that aims to capture 20% of its distribution. Then we will generate a prioritisation that aims to capture the neutral evolutionary processes acting on this species. To do this we will generate a prioritisation that secures indiviudals in different parts of its geographic range. Next, we will generate a prioritisation that aims to capture the adaptive evolutionary processes acting on this species, by securing individuals in different environmental conditions. Lastly, we will also generate a prioritisation that secures both of these processes and see how this prioritisations compares to the previous prioritisations.</p>
</div>
<div id="data-1" class="section level3">
<h3>Data</h3>
<p>Survey data for this species was obtained from <a href="http://birdlife.org.au/projects/atlas-and-birdata">BirdLife Australia</a>. This was used to generate a probability map (1km^2 resolution) of its distribution across Australia. To improve the accuracy of this map, areas well outside of its known distribution were set to 0. This was acheived by masking out <a href="https://www.environment.gov.au/land/nrs/science/ibra">biogeographic regions</a> where the species was not observed and did not have a neighboring region where the species was observed. The resulting map is stored in the <code>cs_spp</code> object.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load data</span>
<span class="kw">data</span>(cs_spp)

<span class="co"># plot species distribution</span>
<span class="kw">plot</span>(cs_spp)</code></pre>
<p>Planning units (10km^2 resolution) were generated across Australia, and then clipped to the <a href="http://www.abs.gov.au/ausstats/abs@.nsf/mf/1259.0.30.001?OpenDocument">Queensland state borders and coastline</a>. To ensure our prioritisations include information on the distribution of existing protected areas, <a href="http://www.protectedplanet.net/">Australia’s current protected area network</a> were intersected with the planning units. Planning units with more than 50% of their area inside a protected area had their status set to two (<a href="http://www.uq.edu.au/marxan/tutorial/module4.html">following conventions in Marxan</a>). Since we do not have cost data, the prioritisations will aim to select the minimum number of planning units required to meet the targets. The planning units are in the <code>cs_pu</code> object.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load data</span>
<span class="kw">data</span>(cs_pu)

## plot planning units
<span class="co"># denote units not inside a protected area with white</span>
<span class="kw">plot</span>(cs_pu[<span class="kw">which</span>(cs_pu$status==<span class="dv">0</span>),], <span class="dt">col=</span><span class="st">'white'</span>)

<span class="co"># denote units inside a protected area with green</span>
<span class="kw">plot</span>(cs_pu[<span class="kw">which</span>(cs_pu$status==<span class="dv">2</span>),], <span class="dt">col=</span><span class="st">'white'</span>)</code></pre>
<p>To map the distribution of environmental conditions across the species’ range, 21 <a href="http://www.worldclim.org/bioclim">bioclimatic layers</a> were obtained. These layers were cropped to Australia and subject to <a href="http://cc.oulu.fi/~jarioksa/softhelp/vegan/html/decorana.html">detrended correspondance analysis</a> to produce two new variables (explaning XX percent of the variation). These layers are stored in the <code>cs_space</code> object.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set up plotting window</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="co"># plot first variable</span>
<span class="kw">plot</span>(cs_space[[<span class="dv">1</span>]])

<span class="co"># plot second variable</span>
<span class="kw">plot</span>(cs_space[[<span class="dv">2</span>]])

<span class="co"># reset window</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre>
</div>
<div id="prioritisations" class="section level3">
<h3>Prioritisations</h3>
<p>To simplify the process of formatting data and generating prioritisations, we can use the <code>rap</code> function. First, we will generate an area-based prioritisation that aims to capture 20% of the rosella’s range. We will use 100 demand points to map the geographic and environmental spaces.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make area-based prioritisation</span>
cs_rs_area &lt;-<span class="st"> </span><span class="kw">rap</span>(cs_pus, cs_species, cs_spaces,
  <span class="dt">area.target=</span><span class="fl">0.2</span>, <span class="dt">space.target=</span><span class="fl">0.2</span>, <span class="dt">n.demand.points=</span>100L,
  <span class="dt">include.geographic.space=</span><span class="ot">TRUE</span>, <span class="dt">formulation=</span><span class="st">'unreliable'</span>
)

<span class="co"># plot prioritisation</span>
<span class="kw">plot</span>(cs_rs_area)

<span class="co"># plot prioritisation in environmental space</span>
<span class="kw">space.plot</span>(cs_rs_area)</code></pre>
</div>
<div id="fragmentation" class="section level3">
<h3>Fragmentation</h3>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
